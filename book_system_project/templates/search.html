{% extends "base.html" %}
    {% block topic %}Search{% endblock %}
    {% block subhead %}
        Search for book here:
    {% endblock %}

    {% block content %}
    <form method="POST">
        {{ form.csrf_token }}
        Search for a title: {{ form.title }} {{ form.review.label }} {{ form.review }}<br><br>
        Search for an author: {{ form.author }}
        or {{ form.select_author }}<br><br>
        Search for a genre: {{ form.genre }}
        or {{ form.select_genre }}<br><br>
        {{ form.rating_min.label }} {{ form.rating_min }}
        {{ form.rating_max.label }} {{ form.rating_max }}
        {{ form.sort_by.label }} {{ form.sort_by }}<br><br>
        {{ form.submit }}
    </form>

    {% if results %}
    <br>We have found {{ count }} books meeting your search criteria:
    <ol>
        {% for result in results %}
            <li><a href="{{ url_for('book_details', book_id=result.id) }}"><span style="color: DarkMagenta;">{{ result.title }}</span></a> by {{ result.author.name }} - Genres:
                {% for genre in result.genres %}
                    {{ genre.name }}{% if not loop.last %}, {% endif %}
                {% endfor %}
               - Rating: {{ result.avg_rating }}
             </li>
        {% endfor %}
    </ol>
    {% else %}
    {% endif %}

    {% endblock %}